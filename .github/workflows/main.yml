name: node js dockerization
on: 
   push:
      branches: 
      - main

jobs: 
 build-and-run:
  runs-on: self-hosted

  steps:
  - name: Checkout code
    uses: actions/checkout@v4

  - name: Docker login
    uses: docker/login-action@v3
    with: 
     username: ${{ secrets.DOCKERHUB_USERNAME }}Â 
     password: ${{ secrets.DOCKERHUB_TOKEN }}

  - name: Build Docker Image
    run: sudo docker build -t test:latest .
    #working-directory: ./cicd-react-application-main

  - name: push docker Image
    run: |
     docker tag test:latest anjuhubdocker/myimages:latest 
     docker push anjuhubdocker/myimages:latest

  - name: Deploy container
    run: |
     docker stop test || true
     docker rm test || true
     docker pull anjuhubdocker/myimages:latest
     docker run -d --name test -p 8080:8080 anjuhubdocker/myimages:latest

 
                       

   
     
    
    

 


  
